<!-- TODO : fix spelling -->

<div ng-controller="taskController">

    <div class="Timer">
        <div class="Timer-label">{{times[0].isRunning ? 'it&rsquo;s time to work' : 'take a break'}}</div>
        <div class="Timer-countdown">{{times[0].value}}</div>
    </div>

    <!-- TODO : if there's time, show statistics of lasted 25 mins tasks  -->
    <!-- <h2>Last round {{lasted.done}} people stayed on task and {{lasted.fail}} did not.</h2> -->

    <!-- TODO:Make a scrollable list -->
    <ul class="Tasks">
        <!-- TODO: style li.success and li.fail -->
        <li class="Tasks-task" ng-repeat="item in tasks" ng-class="{'Tasks-task--success':item.status == 1,'Tasks-task--fail':item.status == 0}">
            <!-- TODO: add Thumb up to each task -->
            <!-- TODO: only show status after the work session is over and the user has said whether it's success -->
            <span class="Tasks-taskOwner">{{getOwner(item) | displayName}}</span>
            <span class="Tasks-taskTitle">{{item.title}}</span>
            <span class="Tasks-taskStatus">{{item.status ? 'Stayed on task!':'Distracted'}}</span>
            <img class="Tasks-taskOwnerImage" src="{{getProfileImage(getOwner(item))}}">
        </li>
    </ul>

    <!-- TODO : get statistic of lasted 25 mins tasks  -->
    <div ng-if="!times[0].isRunning">
        <h2> There are {{lastRoundDoneCount()}} tasks done and {{lastRoundFailCount()}}  fail in last 25 mins</h2>
    </div>

    <div class="Controls">

        <blaze-template name="loginButtons" class="Controls-login"></blaze-template>

        <div ng-show="currentUser">

            <div ng-show="times[0].isRunning && !mytask[0]">
                <input placeholder="What will you focus on?" ng-model="todo">
                <button ng-click="join()">Join now</button>
            </div>

            <div ng-show="mytask[0] && times[0].isRunning">
                Now focusing on: {{mytask[0].title}}
            </div>

            <div ng-if="!times[0].isRunning && mytask[0] && mytask[0].status==2">
                <h2>Did you stay focused on your task?</h2>
                <button ng-click="confirm(1)">Heck yes</button>
                <button ng-click="confirm(0)">Nope</button>
            </div>
            
            <div ng-if="!times[0].isRunning && !mytask[0]">
                <h2>Break time! Take a walk.</h2>
            </div>

        </div>

    </div>





</div>
